---
/**
 * Button Component
 *
 * Accessible, theme-aware button with variants, sizes, and states
 *
 * @component
 */

export interface Props {
    variant?: "primary" | "accent" | "secondary" | "ghost" | "danger";
    size?: "sm" | "md" | "lg";
    type?: "button" | "submit" | "reset";
    disabled?: boolean;
    loading?: boolean;
    fullWidth?: boolean;
    href?: string;
    external?: boolean;
    class?: string;
}

const {
    variant = "primary",
    size = "md",
    type = "button",
    disabled = false,
    loading = false,
    fullWidth = false,
    href,
    external = false,
    class: className = "",
} = Astro.props;

const variantClasses = {
    primary: "btn-primary",
    accent: "btn-accent",
    secondary: "btn-secondary",
    ghost: "btn-ghost",
    danger: "btn-danger",
};

const sizeClasses = {
    sm: "text-sm px-3 py-1.5",
    md: "text-base px-4 py-2.5",
    lg: "text-lg px-6 py-3",
};

const Tag = href ? "a" : "button";
const buttonType = href ? undefined : type;
const rel = external ? "noopener noreferrer" : undefined;
const target = external ? "_blank" : undefined;
---

<Tag
    type={buttonType}
    href={href}
    rel={rel}
    target={target}
    disabled={disabled || loading}
    aria-disabled={disabled || loading ? "true" : "false"}
    aria-busy={loading ? "true" : "false"}
    class:list={[
        variantClasses[variant],
        sizeClasses[size],
        fullWidth && "w-full",
        (disabled || loading) && "opacity-50 cursor-not-allowed",
        className,
    ]}
>
    {
        loading && (
            <svg
                class="animate-spin -ml-1 mr-3 h-5 w-5"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                aria-hidden="true"
            >
                <circle
                    class="opacity-25"
                    cx="12"
                    cy="12"
                    r="10"
                    stroke="currentColor"
                    stroke-width="4"
                />
                <path
                    class="opacity-75"
                    fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                />
            </svg>
        )
    }
    <slot />
</Tag>
