---
/**
 * Toggle Component
 *
 * iOS-style toggle switch for boolean settings
 *
 * @component
 */

export interface Props {
    name: string;
    id?: string;
    label?: string;
    checked?: boolean;
    disabled?: boolean;
    size?: "sm" | "md" | "lg";
    class?: string;
}

const {
    name,
    id = name,
    label,
    checked = false,
    disabled = false,
    size = "md",
    class: className = "",
} = Astro.props;

const sizeClasses = {
    sm: {
        track: "w-9 h-5",
        thumb: "h-4 w-4",
        translate: "peer-checked:translate-x-4",
    },
    md: {
        track: "w-11 h-6",
        thumb: "h-5 w-5",
        translate: "peer-checked:translate-x-5",
    },
    lg: {
        track: "w-14 h-7",
        thumb: "h-6 w-6",
        translate: "peer-checked:translate-x-7",
    },
};

const sizes = sizeClasses[size];
---

<div class:list={["flex items-center gap-3", className]}>
    <input
        type="checkbox"
        role="switch"
        name={name}
        id={id}
        checked={checked}
        disabled={disabled}
        aria-checked={checked ? "true" : "false"}
        class="peer sr-only"
    />

    <label
        for={id}
        class:list={[
            "relative cursor-pointer rounded-full transition-colors",
            "peer-focus:ring-4 peer-focus:ring-primary/20",
            "peer-disabled:opacity-50 peer-disabled:cursor-not-allowed",
            "peer-checked:bg-primary bg-border-primary",
            sizes.track,
        ]}
    >
        <span
            class:list={[
                "absolute top-0.5 left-0.5 rounded-full bg-white transition-transform",
                "shadow-md",
                sizes.thumb,
                sizes.translate,
            ]}
            aria-hidden="true"></span>
    </label>

    {
        label && (
            <span
                class:list={[
                    "text-sm font-medium text-text-primary select-none",
                    disabled && "opacity-50",
                ]}
            >
                {label}
            </span>
        )
    }
</div>

<style>
    /* Smooth toggle animation */
    input[role="switch"]:checked + label span {
        animation: toggleSlide 0.2s ease-out;
    }

    @keyframes toggleSlide {
        0% {
            transform: translateX(0) scale(1);
        }
        50% {
            transform: translateX(25%) scale(0.9);
        }
        100% {
            transform: translateX(var(--tw-translate-x)) scale(1);
        }
    }
</style>
