---
/**
 * Avatar Component
 *
 * User avatar with image, initials, or icon fallback
 *
 * @component
 */

export interface Props {
    src?: string;
    alt?: string;
    size?: "xs" | "sm" | "md" | "lg" | "xl";
    initials?: string;
    status?: "online" | "offline" | "away" | "busy";
    class?: string;
}

const {
    src,
    alt,
    size = "md",
    initials,
    status,
    class: className = "",
} = Astro.props;

const sizeClasses = {
    xs: "h-6 w-6 text-xs",
    sm: "h-8 w-8 text-sm",
    md: "h-10 w-10 text-base",
    lg: "h-12 w-12 text-lg",
    xl: "h-16 w-16 text-2xl",
};

const statusClasses = {
    online: "bg-success",
    offline: "bg-text-tertiary",
    away: "bg-warning",
    busy: "bg-error",
};

const statusSizeClasses = {
    xs: "h-1.5 w-1.5",
    sm: "h-2 w-2",
    md: "h-2.5 w-2.5",
    lg: "h-3 w-3",
    xl: "h-4 w-4",
};
---

<div class:list={["relative inline-block", className]}>
    <div
        class:list={[
            "rounded-full overflow-hidden flex items-center justify-center font-semibold",
            "bg-primary/10 text-primary",
            sizeClasses[size],
        ]}
    >
        {
            src ? (
                <img
                    src={src}
                    alt={alt || "Avatar"}
                    class="h-full w-full object-cover"
                />
            ) : initials ? (
                <span>{initials}</span>
            ) : (
                <svg
                    class="h-2/3 w-2/3 text-text-tertiary"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                >
                    <path
                        fill-rule="evenodd"
                        d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
                        clip-rule="evenodd"
                    />
                </svg>
            )
        }
    </div>

    {
        status && (
            <span
                class:list={[
                    "absolute bottom-0 right-0 block rounded-full ring-2 ring-elevated",
                    statusClasses[status],
                    statusSizeClasses[size],
                ]}
                aria-label={`Status: ${status}`}
            />
        )
    }
</div>
