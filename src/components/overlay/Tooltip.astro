---
/**
 * Tooltip Component
 *
 * Hover tooltip with positioning
 *
 * @component
 */

export interface Props {
    content: string;
    placement?: "top" | "bottom" | "left" | "right";
    delay?: number;
    class?: string;
}

const {
    content,
    placement = "top",
    delay = 200,
    class: className = "",
} = Astro.props;

const placementClasses = {
    top: "bottom-full left-1/2 -translate-x-1/2 mb-2",
    bottom: "top-full left-1/2 -translate-x-1/2 mt-2",
    left: "right-full top-1/2 -translate-y-1/2 mr-2",
    right: "left-full top-1/2 -translate-y-1/2 ml-2",
};

const arrowClasses = {
    top: "top-full left-1/2 -translate-x-1/2 border-t-elevated border-x-transparent border-b-transparent",
    bottom: "bottom-full left-1/2 -translate-x-1/2 border-b-elevated border-x-transparent border-t-transparent",
    left: "left-full top-1/2 -translate-y-1/2 border-l-elevated border-y-transparent border-r-transparent",
    right: "right-full top-1/2 -translate-y-1/2 border-r-elevated border-y-transparent border-l-transparent",
};
---

<div
    x-data="{ show: false, timeout: null }"
    @mouseenter={`timeout = setTimeout(() => show = true, ${delay})`}
    @mouseleave="clearTimeout(timeout); show = false"
    @focus={`timeout = setTimeout(() => show = true, ${delay})`}
    @blur="clearTimeout(timeout); show = false"
    class:list={["relative inline-block", className]}
>
    <!-- Trigger -->
    <slot />

    <!-- Tooltip -->
    <div
        x-show="show"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0 scale-95"
        x-transition:enter-end="opacity-100 scale-100"
        x-transition:leave="transition ease-in duration-150"
        x-transition:leave-start="opacity-100"
        x-transition:leave-end="opacity-0"
        role="tooltip"
        class:list={[
            "absolute z-tooltip whitespace-nowrap px-3 py-2 text-sm font-medium text-white bg-elevated rounded-lg shadow-lg pointer-events-none",
            placementClasses[placement],
        ]}
    >
        {content}

        <!-- Arrow -->
        <div
            class:list={["absolute w-0 h-0 border-4", arrowClasses[placement]]}
            aria-hidden="true"
        >
        </div>
    </div>
</div>
